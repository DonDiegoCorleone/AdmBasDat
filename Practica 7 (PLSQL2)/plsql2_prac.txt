create or replace PACKAGE BODY PK_ASIGNACION_GRUPOS AS
PROCEDURE PR_ASIGNA_ASIGNADOS IS

CURSOR c_nuevo_ingreso IS SELECT A.GRUPOS_ASIGNADOS,A.NEXPEDIENTE FROM ALUMNOS_EXT A where regexp_like (grupos_asignados,'[A-Z]');
JOIN
NUEVO_INGRESO P ON A.DNI=P.DOCUMENTO;
TITULACION VARCHAR2(200);
LETRA BOOLEAN;
P NUMBER;
GUION NUMBER;

BEGIN
LETRA:=TRUE;

FOR varAlumno in c_nuevo_ingreso loop
GUION:=INSTR(varAlumno.grupos_asignados,'-');
WHILE GUION!=0 LOOP

IF(SUBSTR(varAlumno.grupos_asignados,GUION+1,GUION+1) = ',') THEN
LETRA:=FALSE;
END IF;

GUION:=INSTR(varAlumno.grupos_asignados,'-',GUION+1);

END LOOP;

IF LETRA=FALSE THEN

END IF;

IF LETRA=TRUE THEN
TITULACION:=SUBSTR(varAlumno.nexpediente,1,4);
NORMALIZA_ASIGNATURAS(varAlumno.grupos_asignados,TITULACION);
--HACER BUCLE
ASIG_REF:=SELECT REFERENCIA FROM ASIGNATURA WHERE CODIGO=
UPDATE ASIGNATURAS_MATRICULA SET GRUPO_ID= WHERE ASIGNATURA_REFERENCIA= AND MATRICULA_EXPEDIENTE=varAlumno.nexpediente;
END IF;

end loop;

END;
END PK_ASIGNACION_GRUPOS;
